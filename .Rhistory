usethis::use_testthat()
source('~/Desktop/truncNormalMoments/R/functions.R')
devtools::test()
source('~/Desktop/truncNormalMoments/R/functions.R')
source('~/Desktop/truncNormalMoments/R/functions.R')
test_that("Cumulants evaluated at point matches analytical expression.", {
expect_equal(get_cumulants("mm", m, s, ul, uh, n), -(n/s**2) + (n/s**2) * ((alphah(m, s, ul, uh) - alphal(m, s, ul, uh)) ** 2 + alphah(m, s, ul, uh) * ush(m, s, ul, uh) - alphal(m, s, ul, uh) * usl(m, s, ul, uh)))
expect_equal(get_cumulants("ms", m, s, ul, uh, n), (-2 * n/s**3) * Ex_min_m(m,s,ul,uh) + (n/s**2) * (alphal(m, s, ul, uh) - alphah(m, s, ul, uh) + alphah(m, s, ul, uh) * ush(m, s, ul, uh) **2 - alphal(m, s, ul, uh) * usl(m, s, ul, uh)**2 + (alphal(m, s, ul, uh) - alphah(m, s, ul, uh)) * (alphal(m, s, ul, uh)*usl(m, s, ul, uh) - alphah(m, s, ul, uh) * ush(m, s, ul, uh)) ))
})
source('~/Desktop/truncNormalMoments/R/functions.R')
source('~/Desktop/truncNormalMoments/R/functions.R')
source('~/Desktop/truncNormalMoments/R/functions.R')
source('~/Desktop/truncNormalMoments/R/functions.R')
source('~/Desktop/truncNormalMoments/R/functions.R')
source('~/Desktop/truncNormalMoments/R/functions.R')
source('~/Desktop/truncNormalMoments/R/functions.R')
source('~/Desktop/truncNormalMoments/R/functions.R')
source('~/Desktop/truncNormalMoments/R/functions.R')
data.60 <- weather[weather$year <= 1970 & weather$year >= 1961 ,]
weather <- as.data.frame(read.csv("simplified-sfo-weather.csv"))
weather["sinf"] <- sin((2 * pi/ 365) * (weather["day"] - 1))
weather["cosf"] <- cos((2 * pi/ 365) * (weather["day"] - 1))
weather.bf90s <- weather[weather$year <= 1990,]
line <- lm(temphigh ~ sinf + cosf, na.action=na.omit, data=weather)
print(summary(line))
data.60 <- weather[weather$year <= 1970 & weather$year >= 1961 ,]
data.70 <- weather[weather$year <= 1980 & weather$year >= 1971,]
data.80 <- weather[weather$year <= 1990 & weather$year >= 1981,]
data.90 <- weather[weather$year <= 2000 & weather$year >= 1991,]
data.00 <- weather[weather$year <= 2010 & weather$year >= 2001,]
data.10 <- weather[weather$year <= 2020 & weather$year >= 2011,]
print(data.60)
data.60 <- weather[weather$year <= 1970 & weather$year >= 1961 ,]
data.70 <- weather[weather$year <= 1980 & weather$year >= 1971,]
data.80 <- weather[weather$year <= 1990 & weather$year >= 1981,]
data.90 <- weather[weather$year <= 2000 & weather$year >= 1991,]
data.00 <- weather[weather$year <= 2010 & weather$year >= 2001,]
data.10 <- weather[weather$year <= 2020 & weather$year >= 2011,]
print(data.90)
data.60 <- weather[weather$year <= 1970 & weather$year >= 1961 ,]
data.70 <- weather[weather$year <= 1980 & weather$year >= 1971,]
data.80 <- weather[weather$year <= 1990 & weather$year >= 1981,]
data.90 <- weather[weather$year <= 2000 & weather$year >= 1991,]
data.00 <- weather[weather$year <= 2010 & weather$year >= 2001,]
data.10 <- weather[weather$year <= 2020 & weather$year >= 2011,]
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(mean(data.60["hightemp"]))
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(mean(data.60["high_temp"]))
weather <- as.data.frame(read.csv("simplified-sfo-weather.csv"))
weather["sinf"] <- sin((2 * pi/ 365) * (weather["day"] - 1))
weather["cosf"] <- cos((2 * pi/ 365) * (weather["day"] - 1))
weather.bf90s <- weather[weather$year <= 1990,]
line <- lm(temphigh ~ sinf + cosf, na.action=na.omit, data=weather)
#print(summary(line))
print(weather)
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(mean(data.60["temphigh"]))
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(data.60["temphigh"])
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(data.60["temphigh"] - pred.60)
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(mean(data.60["temphigh"] - pred.60))
weather <- as.data.frame(read.csv("simplified-sfo-weather.csv"))
weather["sinf"] <- sin((2 * pi/ 365) * (weather["day"] - 1))
weather["cosf"] <- cos((2 * pi/ 365) * (weather["day"] - 1))
weather.bf90s <- weather[weather$year <= 1990,]
line <- lm(temphigh ~ sinf + cosf, na.action=na.omit, data=weather)
#print(summary(line))
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
mean(data.60["temphigh"] - pred.60)
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
mean(data.60["temphigh"] - pred.60["temphigh"])
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(mean(data.60["temphigh"] - pred.60["temphigh"]))
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(mean((data.60["temphigh"] - pred.60)["temphigh"]))
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(mean((data.60["temphigh"] - pred.60)$temphigh))
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(mean((data.60["temphigh"] - pred.60)$temphigh))
print(mean((data.70["temphigh"] - pred.70)$temphigh))
print(mean((data.80["temphigh"] - pred.80)$temphigh))
print(mean((data.90["temphigh"] - pred.90)$temphigh))
print(mean((data.00["temphigh"] - pred.00)$temphigh))
print(mean((data.10["temphigh"] - pred.10)$temphigh))
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(paste0("60's average difference: ", mean((data.60["temphigh"] - pred.60)$temphigh)))
print(mean((data.70["temphigh"] - pred.70)$temphigh))
print(mean((data.80["temphigh"] - pred.80)$temphigh))
print(mean((data.90["temphigh"] - pred.90)$temphigh))
print(mean((data.00["temphigh"] - pred.00)$temphigh))
print(mean((data.10["temphigh"] - pred.10)$temphigh))
data.60 <- na.omit(weather[weather$year <= 1970 & weather$year >= 1961 ,])
data.70 <- na.omit(weather[weather$year <= 1980 & weather$year >= 1971,])
data.80 <- na.omit(weather[weather$year <= 1990 & weather$year >= 1981,])
data.90 <- na.omit(weather[weather$year <= 2000 & weather$year >= 1991,])
data.00 <- na.omit(weather[weather$year <= 2010 & weather$year >= 2001,])
data.10 <- na.omit(weather[weather$year <= 2020 & weather$year >= 2011,])
pred.60 <- predict(line, data.60, na.action=na.omit)
pred.70 <- predict(line, data.70, na.action=na.omit)
pred.80 <- predict(line, data.80, na.action=na.omit)
pred.90 <- predict(line, data.90, na.action=na.omit)
pred.00 <- predict(line, data.00, na.action=na.omit)
pred.10 <- predict(line, data.10, na.action=na.omit)
print(paste0("60's average difference: ", mean((data.60["temphigh"] - pred.60)$temphigh)))
print(paste0("70's average difference: ", mean((data.70["temphigh"] - pred.70)$temphigh)))
print(paste0("80's average difference: ", mean((data.80["temphigh"] - pred.80)$temphigh)))
print(paste0("90's average difference: ", mean((data.90["temphigh"] - pred.90)$temphigh)))
print(paste0("00's average difference: ", mean((data.00["temphigh"] - pred.00)$temphigh)))
print(paste0("10's average difference: ", mean((data.10["temphigh"] - pred.10)$temphigh)))
